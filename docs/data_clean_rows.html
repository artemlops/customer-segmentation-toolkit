---

title: Clean dataset


keywords: fastai
sidebar: home_sidebar

summary: "remove duplicates, N/A and calculate bad order cancellations"
description: "remove duplicates, N/A and calculate bad order cancellations"
nb_path: "nbs/02_data_clean_rows.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02_data_clean_rows.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clean_drop_na" class="doc_header"><code>clean_drop_na</code><a href="https://github.com/artemlops/elab2team2/tree/master/elab2team2/data/clean_rows.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clean_drop_na</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clean_drop_duplicates" class="doc_header"><code>clean_drop_duplicates</code><a href="https://github.com/artemlops/elab2team2/tree/master/elab2team2/data/clean_rows.py#L15" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clean_drop_duplicates</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clean_remove_bad_order_cancellations" class="doc_header"><code>clean_remove_bad_order_cancellations</code><a href="https://github.com/artemlops/elab2team2/tree/master/elab2team2/data/clean_rows.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clean_remove_bad_order_cancellations</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>
<p>Returns a copy of <code>df</code> that doesn't include the following orders:</p>
<ol>
<li>a cancel order exists without counterpart,</li>
<li>a order for which there exists at least one counterpart with exactly the same quantity.
NOTE: time complexity is O(n).</li>
</ol>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clean_rows" class="doc_header"><code>clean_rows</code><a href="https://github.com/artemlops/elab2team2/tree/master/elab2team2/data/clean_rows.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clean_rows</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">elab2team2.data.load_split</span> <span class="kn">import</span> <span class="n">load_csv</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">load_csv</span><span class="p">(</span><span class="s1">&#39;../data/01_df_split_offline_online/no_live_data.csv&#39;</span><span class="p">)</span>
<span class="n">clean_rows</span><span class="p">(</span><span class="n">df</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:entry_to_remove: 1
INFO:root:doubtfull_entry: 8
INFO:root:nb of entries to delete: 0
INFO:root:Empty DataFrame
Columns: [InvoiceNo, StockCode, Description, Quantity, InvoiceDate, UnitPrice, CustomerID, Country, QuantityCanceled]
Index: []
INFO:root:    InvoiceNo StockCode                   Description  Quantity  \
208    536389     22191        IVORY DINER WALL CLOCK         2   
197    536389     22941  CHRISTMAS LIGHTS 10 REINDEER         6   
210    536389     22196  SMALL HEART MEASURING SPOONS        24   
209    536389     22195  LARGE HEART MEASURING SPOONS        24   
207    536389     22192         BLUE DINER WALL CLOCK         2   

            InvoiceDate  UnitPrice CustomerID    Country  QuantityCanceled  \
208 2010-12-01 10:03:00       8.50      12431  Australia                 0   
197 2010-12-01 10:03:00       8.50      12431  Australia                 0   
210 2010-12-01 10:03:00       0.85      12431  Australia                 0   
209 2010-12-01 10:03:00       1.65      12431  Australia                 0   
207 2010-12-01 10:03:00       8.50      12431  Australia                 0   

     TotalPrice  
208        17.0  
197        51.0  
210        20.4  
209        39.6  
207        17.0  
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>536365</td>
      <td>85123A</td>
      <td>WHITE HANGING HEART T-LIGHT HOLDER</td>
      <td>6</td>
      <td>2010-12-01 08:26:00</td>
      <td>2.55</td>
      <td>17850</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1</th>
      <td>536365</td>
      <td>71053</td>
      <td>WHITE METAL LANTERN</td>
      <td>6</td>
      <td>2010-12-01 08:26:00</td>
      <td>3.39</td>
      <td>17850</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>2</th>
      <td>536365</td>
      <td>84406B</td>
      <td>CREAM CUPID HEARTS COAT HANGER</td>
      <td>8</td>
      <td>2010-12-01 08:26:00</td>
      <td>2.75</td>
      <td>17850</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>3</th>
      <td>536365</td>
      <td>84029G</td>
      <td>KNITTED UNION FLAG HOT WATER BOTTLE</td>
      <td>6</td>
      <td>2010-12-01 08:26:00</td>
      <td>3.39</td>
      <td>17850</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>4</th>
      <td>536365</td>
      <td>84029E</td>
      <td>RED WOOLLY HOTTIE WHITE HEART.</td>
      <td>6</td>
      <td>2010-12-01 08:26:00</td>
      <td>3.39</td>
      <td>17850</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>536520</td>
      <td>22469</td>
      <td>HEART OF WICKER SMALL</td>
      <td>1</td>
      <td>2010-12-01 12:43:00</td>
      <td>1.65</td>
      <td>14729</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>996</th>
      <td>536520</td>
      <td>22100</td>
      <td>SKULLS SQUARE TISSUE BOX</td>
      <td>1</td>
      <td>2010-12-01 12:43:00</td>
      <td>1.25</td>
      <td>14729</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>997</th>
      <td>536520</td>
      <td>22096</td>
      <td>PINK PAISLEY SQUARE TISSUE BOX</td>
      <td>1</td>
      <td>2010-12-01 12:43:00</td>
      <td>1.25</td>
      <td>14729</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>998</th>
      <td>536520</td>
      <td>22583</td>
      <td>PACK OF 6 HANDBAG GIFT BOXES</td>
      <td>1</td>
      <td>2010-12-01 12:43:00</td>
      <td>2.55</td>
      <td>14729</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>999</th>
      <td>536520</td>
      <td>21358</td>
      <td>TOAST ITS - HAPPY BIRTHDAY</td>
      <td>2</td>
      <td>2010-12-01 12:43:00</td>
      <td>1.25</td>
      <td>14729</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
<p>976 rows Ã— 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

